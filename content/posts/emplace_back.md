---
title: "push_back VS emplace_back"
date: 2021-08-04T21:37:51+08:00
draft: false
tags: [C++]
---
C++ å®¹å™¨ vector, list, deque éƒ½æä¾›äº†é’ˆå¯¹åºåˆ—å®¹å™¨å°¾éƒ¨çš„æ“ä½œï¼Œæ¯”å¦‚ push_backï¼Œpop_backã€‚C++11 æä¾›äº†æ–°çš„æ“ä½œ: emplace_backã€‚ä¸¤è€…æœ‰ä½•åŒºåˆ«å‘¢

```c++
c.push_back(x)
c.pop_back()
c.emplace_back(args)
```

push_back çš„è¾“å…¥å‚æ•°ä¸ºè¦æ’å…¥çš„å®¹å™¨å…ƒç´ å¯¹è±¡ï¼Œå®¹å™¨é€šè¿‡æ‹·è´æˆ–è€…ç§»åŠ¨è¯¥å¯¹è±¡æŠŠå®ƒæ”¾å…¥å®¹å™¨çš„æœ«å°¾ã€‚emplace_back åˆ™ä¸åŒï¼Œå®ƒçš„æ¥å—å‚æ•°ä¸ºæ„é€ å®¹å™¨å…ƒç´ æ‰€éœ€è¦çš„å‚æ•°ï¼Œå®¹å™¨ä¼šä½¿ç”¨è¿™äº›å‚æ•°ç›´æ¥åœ¨å®¹å™¨å†…çš„å¯¹åº”ä½ç½®åˆ›å»ºå®¹å™¨å¯¹è±¡ã€‚


ä¸¾ä¸ªğŸŒ°ï¼š
```c++
class Student {
    Student(string name, int age, string address);

private:
    std::string address;
    std::string name;
    int age;
}
```

å¦‚æœæ˜¯ä½¿ç”¨ `push_back`ï¼Œéœ€è¦å…ˆæ„é€  Student å¯¹è±¡ç„¶åæŠŠè¯¥å¯¹è±¡é€šè¿‡ push_back æ‹·è´åˆ°å®¹å™¨ä¸­
```C++
void use(vector<Student>& students) {
    Student s ("Carina", 7, "GUANHEJINTING");
    students.push_back(s);
}
```

å¦‚æœæ˜¯ä½¿ç”¨ `emplace_back`ï¼Œç›´æ¥æŠŠæ„é€  Student éœ€è¦çš„å‚æ•°ä¼ é€’ç»™ emplace_back å³å¯
```C++
void use(vector<Student>& students) {
    students.emplace_back("Carina", 7, "GUANHEJINTING");
}    
```


ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨ push_back ä¼šå¤šäº†ä¸€æ­¥å¯¹å¯¹è±¡æ‹·è´æˆ–è€…ç§»åŠ¨çš„å·¥ä½œã€‚å¦‚æœå¯¹äºä¸€äº›å¯¹è±¡è¿™ä¸ªæ“ä½œï¼ˆæ‹·è´æˆ–è€…ç§»åŠ¨ï¼‰æ¯”è¾ƒè€—æ—¶çš„æƒ…å†µï¼Œä¼˜å…ˆä½¿ç”¨ emplace_back ä¼šæ¯”è¾ƒå¥½ä¸€ç‚¹ã€‚å¯¹äºå¤§éƒ¨åˆ†æƒ…å†µæ¥è¯´ï¼Œè¿™ä¸ªæ•ˆç‡é—®é¢˜éƒ½åº”è¯¥ä¸æ˜¯é—®é¢˜ã€‚

emplace_back æœ‰å¦å¤–çš„ä¸€ä¸ªç¼ºç‚¹ï¼Œç”±äºå®ƒè¦æ ¹æ®å‚æ•°æ„é€ ä¸€ä¸ªå®¹å™¨å…ƒç´ ï¼Œå®ƒæ„é€ å…ƒç´ çš„è·¯å¾„å¯èƒ½ä¸æ˜¯æˆ‘ä»¬çš„åŸæ„ï¼Œæ¯”å¦‚å¯èƒ½ç»è¿‡äº†ä¸æ˜“è§‰å¯Ÿçš„éšå¼è½¬æ¢ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼Œå®¹å™¨ä¼šä½¿ç”¨ 20 æ¥æ„é€ ä¸€ä¸ª std::vectorï¼Œè¿™æ ·åœ¨ vs ä¸­å°±æ’å…¥äº†ä¸€ä¸ªåŒ…å« 20 ä¸ªå…ƒç´ çš„ vectorï¼Œè€Œä¸æ˜¯æ’å…¥äº† 20 æœ¬èº«ã€‚è¿™ç§é”™è¯¯åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ä½“ç°ã€‚

```C++
std::vector<std::vector<int>> vs;
vs.emplace_back(20);
```

æ­¤å¤–ï¼Œinsert å’Œ emplace ï¼ˆç›¸æ¯”äº push_back, emplace_back), ä¹Ÿæœ‰ç±»ä¼¼çš„åŒºåˆ«

[å‚è€ƒ](https://abseil.io/tips/112)

